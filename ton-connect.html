<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Connect TON Wallet</title>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
</head>
<body style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;background:#0e0e0e;color:white;">

  <h1>üéß Insane Nights & Days</h1>
  <p>Connecte ton wallet TON pour commencer √† raver !</p>

  <div id="ton-connect-button"></div>

  <p id="status"></p>

  <script>
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
      manifestUrl: "https://insanenightsanddays.netlify.app/tonconnect-manifest.json?v=" + Date.now(),
      buttonRootId: "ton-connect-button"
    });

    // Attente de la connexion
    tonConnectUI.onStatusChange(async (wallet) => {
      if (wallet) {
        const address = wallet.account.address;
        document.getElementById("status").textContent = `‚úÖ Wallet connect√© : ${address}`;

        // Envoi automatique √† Telegram WebApp si pr√©sent
        if (window.Telegram && Telegram.WebApp) {
          Telegram.WebApp.ready();
          Telegram.WebApp.sendData(address);
        }
      } else {
        document.getElementById("status").textContent = "‚ùå Wallet non connect√©";
      }
    });
  </script>
 <script type="module">
  import { TonConnect } from "@tonconnect/sdk";

  const connector = new TonConnect({
    manifestUrl: "https://insanenightsanddays.netlify.app/tonconnect-manifest.json"
  });

  connector.restoreConnection().then(async () => {
    if (connector.connected) {
      const walletAddress = connector.account.address;
      console.log("Wallet connect√© :", walletAddress);

      // Envoie au bot Telegram (MiniApp)
      if (window.Telegram && window.Telegram.WebApp) {
        Telegram.WebApp.sendData(walletAddress);
        Telegram.WebApp.close(); // facultatif
      }
    }
  });
</script>

</body>
</html>
